<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Movie & TV Picker</title>
  <style>
    :root{
      --bg:#0f1115;--card:#151922;--muted:#8a90a2;--text:#eef1f6;--accent:#d64550;--accent-2:#2e3a59;--ok:#2ea043;--warn:#f0b429;
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,sans-serif;background:linear-gradient(180deg,#0f1115,#0c0d11);color:var(--text)}
    .wrap{max-width:980px;margin:40px auto;padding:0 16px}
    h1{font-size:28px;margin:0 0 16px}
    p.lead{color:var(--muted);margin-top:0}
    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    @media(min-width:860px){.grid{grid-template-columns:1fr 1fr}}
    .card{background:var(--card);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);box-shadow:0 10px 30px rgba(0,0,0,.3)}
    .card h2{margin:0 0 12px;font-size:20px}
    .pad{padding:18px}
    .row{display:flex;gap:10px}
    input[type=text]{flex:1;background:#0d1017;color:var(--text);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px 14px;outline:none}
    input::placeholder{color:#5d6578}
    button{border:0;border-radius:12px;padding:12px 14px;cursor:pointer;font-weight:600}
    .btn{background:#202533;color:var(--text);}
    .btn:hover{filter:brightness(1.05)}
    .btn-accent{background:var(--accent);color:white}
    .btn-accent-2{background:var(--accent-2);color:white}
    .btn-ok{background:var(--ok);color:white}
    .btn-warn{background:var(--warn);color:#1b1400}
    .list{margin:12px 0 0;padding:0;list-style:none;max-height:220px;overflow:auto;border:1px dashed rgba(255,255,255,.08);border-radius:12px}
    .list li{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.05)}
    .list li:last-child{border-bottom:0}
    .pill{display:inline-flex;align-items:center;gap:8px;background:#0d1017;border:1px solid rgba(255,255,255,.08);padding:8px 10px;border-radius:999px}
    .muted{color:var(--muted)}
    .section-title{display:flex;align-items:center;justify-content:space-between;margin:0 0 12px}
    .small{font-size:12px;color:var(--muted)}
    .empty{padding:20px;text-align:center;color:var(--muted)}
    .stack{display:flex;flex-wrap:wrap;gap:8px}
    .bar{display:flex;gap:8px;flex-wrap:wrap}
    .selected{display:flex;flex-direction:column;gap:10px}
    .selected .what{font-size:18px;font-weight:700}
    .inline-actions{display:flex;gap:8px;flex-wrap:wrap}
    .spacer{height:8px}
    .footer{margin:22px 0;color:var(--muted);font-size:12px;text-align:center}
    .danger{background:#a11;color:white}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Movie & TV Picker</h1>
    <p class="lead">Add titles to the pools, then let the app randomly pick one to watch. Skip puts it back; Mark as watched removes it from the pool. Everything is saved to your browser.</p>

    <div class="grid">
      <!-- Movies -->
      <section class="card">
        <div class="pad">
          <div class="section-title">
            <h2>Movies</h2>
            <div class="small" id="movies-count">0 in pool</div>
          </div>
          <div class="row">
            <input id="movie-input" type="text" placeholder="Add a movie titleâ€¦" />
            <button class="btn btn-accent" id="movie-add">Add</button>
          </div>
          <div class="spacer"></div>
          <div class="bar">
            <button class="btn btn-accent-2" id="movie-pick">ðŸŽ² Pick random movie</button>
            <button class="btn" id="movie-clear">Clear pool</button>
          </div>
          <ul class="list" id="movies-list"></ul>
          <div class="empty" id="movies-empty" hidden>No movies yet. Add a few above.</div>
        </div>
      </section>

      <!-- TV Shows -->
      <section class="card">
        <div class="pad">
          <div class="section-title">
            <h2>TV Shows</h2>
            <div class="small" id="shows-count">0 in pool</div>
          </div>
          <div class="row">
            <input id="show-input" type="text" placeholder="Add a TV showâ€¦" />
            <button class="btn btn-accent" id="show-add">Add</button>
          </div>
          <div class="spacer"></div>
          <div class="bar">
            <button class="btn btn-accent-2" id="show-pick">ðŸŽ² Pick random show</button>
            <button class="btn" id="show-clear">Clear pool</button>
          </div>
          <ul class="list" id="shows-list"></ul>
          <div class="empty" id="shows-empty" hidden>No shows yet. Add a few above.</div>
        </div>
      </section>
    </div>

    <!-- Current selections -->
    <section class="card" style="margin-top:16px">
      <div class="pad">
        <div class="section-title"><h2>Current Picks</h2></div>
        <div class="grid" style="grid-template-columns:1fr 1fr">
          <div class="selected">
            <div class="muted">Movie</div>
            <div id="selected-movie" class="what">â€”</div>
            <div class="inline-actions">
              <button class="btn" id="movie-skip" disabled>Skip</button>
              <button class="btn btn-ok" id="movie-watch" disabled>Mark watched</button>
            </div>
          </div>
          <div class="selected">
            <div class="muted">TV Show</div>
            <div id="selected-show" class="what">â€”</div>
            <div class="inline-actions">
              <button class="btn" id="show-skip" disabled>Skip</button>
              <button class="btn btn-ok" id="show-watch" disabled>Mark watched</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Watched -->
    <section class="card" style="margin-top:16px">
      <div class="pad">
        <div class="section-title">
          <h2>Watched</h2>
          <div class="bar">
            <button class="btn" id="clear-watched">Clear watched</button>
          </div>
        </div>
        <div class="grid">
          <div>
            <div class="muted small" style="margin-bottom:8px">Movies</div>
            <div id="watched-movies" class="stack"></div>
          </div>
          <div>
            <div class="muted small" style="margin-bottom:8px">TV Shows</div>
            <div id="watched-shows" class="stack"></div>
          </div>
        </div>
      </div>
    </section>

    <div class="footer">Tip: Press <strong>Enter</strong> to add a title quickly. Data is stored locally (no accounts).</div>
  </div>

  <script>
    // --- State & persistence ---
    const LS_KEYS = {
      moviesPool: 'picker_movies_pool',
      showsPool: 'picker_shows_pool',
      moviesWatched: 'picker_movies_watched',
      showsWatched: 'picker_shows_watched',
      selectedMovie: 'picker_selected_movie',
      selectedShow: 'picker_selected_show',
    };

    const state = {
      moviesPool: loadArray(LS_KEYS.moviesPool),
      showsPool: loadArray(LS_KEYS.showsPool),
      moviesWatched: loadArray(LS_KEYS.moviesWatched),
      showsWatched: loadArray(LS_KEYS.showsWatched),
      selectedMovie: loadString(LS_KEYS.selectedMovie),
      selectedShow: loadString(LS_KEYS.selectedShow),
    };

    // Ensure selected items aren't duplicated in pool
    if (state.selectedMovie) state.moviesPool = state.moviesPool.filter(t => !sameTitle(t, state.selectedMovie));
    if (state.selectedShow) state.showsPool = state.showsPool.filter(t => !sameTitle(t, state.selectedShow));

    function loadArray(key){
      try { const raw = localStorage.getItem(key); return raw ? JSON.parse(raw) : []; } catch { return []; }
    }
    function loadString(key){
      try { return localStorage.getItem(key) || ''; } catch { return ''; }
    }
    function save(){
      localStorage.setItem(LS_KEYS.moviesPool, JSON.stringify(state.moviesPool));
      localStorage.setItem(LS_KEYS.showsPool, JSON.stringify(state.showsPool));
      localStorage.setItem(LS_KEYS.moviesWatched, JSON.stringify(state.moviesWatched));
      localStorage.setItem(LS_KEYS.showsWatched, JSON.stringify(state.showsWatched));
      localStorage.setItem(LS_KEYS.selectedMovie, state.selectedMovie || '');
      localStorage.setItem(LS_KEYS.selectedShow, state.selectedShow || '');
    }

    // --- Utilities ---
    function cleanTitle(s){ return (s||'').trim().replace(/\s+/g,' '); }
    function sameTitle(a,b){ return a?.toLowerCase() === b?.toLowerCase(); }
    function addUnique(arr, title){
      const t = cleanTitle(title);
      if(!t) return {ok:false, reason:'empty'};
      if(arr.some(x=>sameTitle(x,t))) return {ok:false, reason:'duplicate'};
      arr.push(t); return {ok:true, value:t};
    }
    function randPick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    // --- DOM refs ---
    const el = {
      movieInput: document.getElementById('movie-input'),
      movieAdd: document.getElementById('movie-add'),
      moviePick: document.getElementById('movie-pick'),
      movieList: document.getElementById('movies-list'),
      movieEmpty: document.getElementById('movies-empty'),
      movieCount: document.getElementById('movies-count'),
      movieSkip: document.getElementById('movie-skip'),
      movieWatch: document.getElementById('movie-watch'),
      selectedMovie: document.getElementById('selected-movie'),

      showInput: document.getElementById('show-input'),
      showAdd: document.getElementById('show-add'),
      showPick: document.getElementById('show-pick'),
      showList: document.getElementById('shows-list'),
      showEmpty: document.getElementById('shows-empty'),
      showCount: document.getElementById('shows-count'),
      showSkip: document.getElementById('show-skip'),
      showWatch: document.getElementById('show-watch'),
      selectedShow: document.getElementById('selected-show'),

      watchedMovies: document.getElementById('watched-movies'),
      watchedShows: document.getElementById('watched-shows'),
      clearWatched: document.getElementById('clear-watched'),

      clearMovies: document.getElementById('movie-clear'),
      clearShows: document.getElementById('show-clear'),
    };

    // --- Renderers ---
    function render(){
      // Movies pool
      el.movieList.innerHTML = '';
      if(state.moviesPool.length === 0){ el.movieEmpty.hidden = false; } else { el.movieEmpty.hidden = true; }
      state.moviesPool.forEach((t, idx)=>{
        const li = document.createElement('li');
        const title = document.createElement('span');
        title.textContent = t;
        const actions = document.createElement('div');
        actions.className = 'inline-actions';
        const rm = button('Remove', 'btn');
        rm.onclick = ()=>{ state.moviesPool.splice(idx,1); save(); render(); };
        actions.appendChild(rm);
        li.appendChild(title); li.appendChild(actions);
        el.movieList.appendChild(li);
      });
      el.movieCount.textContent = `${state.moviesPool.length} in pool`;

      // Shows pool
      el.showList.innerHTML = '';
      if(state.showsPool.length === 0){ el.showEmpty.hidden = false; } else { el.showEmpty.hidden = true; }
      state.showsPool.forEach((t, idx)=>{
        const li = document.createElement('li');
        const title = document.createElement('span');
        title.textContent = t;
        const actions = document.createElement('div');
        actions.className = 'inline-actions';
        const rm = button('Remove', 'btn');
        rm.onclick = ()=>{ state.showsPool.splice(idx,1); save(); render(); };
        actions.appendChild(rm);
        li.appendChild(title); li.appendChild(actions);
        el.showList.appendChild(li);
      });
      el.showCount.textContent = `${state.showsPool.length} in pool`;

      // Selected
      el.selectedMovie.textContent = state.selectedMovie || 'â€”';
      el.selectedShow.textContent = state.selectedShow || 'â€”';
      el.movieSkip.disabled = !state.selectedMovie;
      el.movieWatch.disabled = !state.selectedMovie;
      el.showSkip.disabled = !state.selectedShow;
      el.showWatch.disabled = !state.selectedShow;

      // Watched
      el.watchedMovies.innerHTML = '';
      state.moviesWatched.forEach((t, i)=>{
        const chip = pill(t, 'Return to pool', ()=>{ state.moviesWatched.splice(i,1); addUnique(state.moviesPool, t); save(); render(); });
        el.watchedMovies.appendChild(chip);
      });
      el.watchedShows.innerHTML = '';
      state.showsWatched.forEach((t, i)=>{
        const chip = pill(t, 'Return to pool', ()=>{ state.showsWatched.splice(i,1); addUnique(state.showsPool, t); save(); render(); });
        el.watchedShows.appendChild(chip);
      });

      // Disable pick buttons if pools empty
      el.moviePick.disabled = state.moviesPool.length === 0 && !state.selectedMovie;
      el.showPick.disabled = state.showsPool.length === 0 && !state.selectedShow;
    }

    function button(text, cls='btn'){
      const b = document.createElement('button');
      b.className = cls; b.textContent = text; return b;
    }
    function pill(label, actionLabel, onClick){
      const p = document.createElement('span'); p.className = 'pill';
      const s = document.createElement('span'); s.textContent = label; p.appendChild(s);
      const b = button(actionLabel, 'btn'); b.style.padding = '6px 10px'; b.onclick = onClick; p.appendChild(b);
      return p;
    }

    // --- Event handlers ---
    el.movieAdd.onclick = ()=> addMovie();
    el.showAdd.onclick = ()=> addShow();
    el.movieInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') addMovie(); });
    el.showInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') addShow(); });

    function addMovie(){
      const t = el.movieInput.value; const res = addUnique(state.moviesPool, t);
      if(res.ok){ el.movieInput.value=''; save(); render(); }
      else if(res.reason==='duplicate'){ toast('Movie already in pool'); }
    }
    function addShow(){
      const t = el.showInput.value; const res = addUnique(state.showsPool, t);
      if(res.ok){ el.showInput.value=''; save(); render(); }
      else if(res.reason==='duplicate'){ toast('Show already in pool'); }
    }

    el.moviePick.onclick = ()=>{
      if(state.selectedMovie){ toast('A movie is already selected. Use Skip or Mark watched.'); return; }
      if(state.moviesPool.length===0){ toast('No movies in pool.'); return; }
      const pick = randPick(state.moviesPool);
      state.selectedMovie = pick;
      state.moviesPool = state.moviesPool.filter(t=>!sameTitle(t,pick));
      save(); render();
    };
    el.showPick.onclick = ()=>{
      if(state.selectedShow){ toast('A show is already selected. Use Skip or Mark watched.'); return; }
      if(state.showsPool.length===0){ toast('No shows in pool.'); return; }
      const pick = randPick(state.showsPool);
      state.selectedShow = pick;
      state.showsPool = state.showsPool.filter(t=>!sameTitle(t,pick));
      save(); render();
    };

    el.movieSkip.onclick = ()=>{ if(!state.selectedMovie) return; addUnique(state.moviesPool, state.selectedMovie); state.selectedMovie=''; save(); render(); };
    el.showSkip.onclick = ()=>{ if(!state.selectedShow) return; addUnique(state.showsPool, state.selectedShow); state.selectedShow=''; save(); render(); };

    el.movieWatch.onclick = ()=>{ if(!state.selectedMovie) return; addUnique(state.moviesWatched, state.selectedMovie); state.selectedMovie=''; save(); render(); };
    el.showWatch.onclick = ()=>{ if(!state.selectedShow) return; addUnique(state.showsWatched, state.selectedShow); state.selectedShow=''; save(); render(); };

    el.clearWatched.onclick = ()=>{
      if(confirm('Clear all watched items?')){ state.moviesWatched=[]; state.showsWatched=[]; save(); render(); }
    };

    el.clearMovies.onclick = ()=>{ if(confirm('Clear the movies pool?')){ state.moviesPool=[]; save(); render(); } };
    el.clearShows.onclick = ()=>{ if(confirm('Clear the shows pool?')){ state.showsPool=[]; save(); render(); } };

    // --- Tiny toast ---
    let toastTimer;
    function toast(msg){
      clearTimeout(toastTimer);
      let t = document.getElementById('toast');
      if(!t){ t = document.createElement('div'); t.id='toast'; document.body.appendChild(t);
        Object.assign(t.style,{position:'fixed',left:'50%',bottom:'24px',transform:'translateX(-50%)',background:'rgba(0,0,0,.8)',color:'#fff',padding:'10px 14px',borderRadius:'10px',border:'1px solid rgba(255,255,255,.12)',zIndex:9999,backdropFilter:'blur(6px)'});
      }
      t.textContent = msg; t.style.opacity='1';
      toastTimer = setTimeout(()=>{ t.style.opacity='0'; }, 1400);
    }

    // Initial render
    render();
  </script>
</body>
</html>
